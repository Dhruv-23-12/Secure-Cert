{% extends "base.html" %}

{% block styles %}
/* Page Layout */
.page-container {
    width: 100%;
    height: 100%;
    padding: 30px; /* Outer padding */
    box-sizing: border-box;
    font-family: 'Times New Roman', Times, serif;
    color: #000;
}

.content-border {
    border: 4px solid #8B4513; /* Brown/Dark Red border */
    height: 100%;
    padding: 20px;
    box-sizing: border-box;
    position: relative;
    display: flex;
    flex-direction: column;
}

/* Header Section */
.header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 20px;
    border-bottom: 2px solid #8B4513;
    padding-bottom: 10px;
}

.logo-section {
    width: 15%;
    display: flex;
    justify-content: center;
    align-items: center;
}

.university-info {
    width: 70%;
    text-align: center;
}

.ppsu-title {
    font-size: 28px;
    font-weight: bold;
    margin: 5px 0;
    color: #1a1a1a;
    letter-spacing: 1px;
}

.ppsu-subtitle {
    font-size: 14px;
    margin: 2px 0;
}

.website {
    color: #0000FF;
    text-decoration: none;
    font-size: 14px;
}

.naac-badge {
    background-color: #DC2626; /* Red */
    color: white;
    font-weight: bold;
    padding: 5px 10px;
    font-size: 12px;
    border-radius: 4px;
    margin-top: 10px;
}

/* Report Title */
.report-title {
    color: #DC2626; /* Red */
    text-align: center;
    font-size: 20px;
    font-weight: bold;
    margin: 10px 0 20px 0;
    text-transform: uppercase;
    text-decoration: underline;
}

/* Date Bar */
.date-bar {
    display: flex;
    justify-content: space-between;
    font-size: 12px;
    font-weight: bold;
    margin-bottom: 10px;
}

/* Common Table Styles */
table {
    width: 100%;
    border-collapse: collapse;
    font-size: 12px;
}

th, td {
    border: 1px solid #000;
    padding: 4px 6px;
}

/* Student Info Table */
.student-info-table {
    margin-bottom: 15px;
}

.student-info-table td.label {
    font-weight: bold;
    width: 15%;
    background-color: #f3f4f6;
}

.student-info-table td.value {
    width: 35%;
    font-weight: bold;
}

/* Course Table */
.course-table {
    margin-bottom: 20px;
}

.course-table th {
    background-color: #e5e7eb;
    text-transform: uppercase;
    font-weight: bold;
}

/* Performance Box */
.performance-container {
    display: flex;
    gap: 20px;
    margin-bottom: 15px;
}

.perf-box {
    flex: 1;
    border: 1px solid #000;
}

.perf-header {
    background-color: #e5e7eb;
    text-align: center;
    padding: 5px;
    border-bottom: 1px solid #000;
    font-weight: bold;
    font-size: 12px;
}

.perf-row {
    display: flex;
    border-bottom: 1px solid #ccc;
}
.perf-row:last-child { border-bottom: none; }

.perf-label {
    flex: 2;
    padding: 4px;
    border-right: 1px solid #ccc;
    font-weight: bold;
}

.perf-value {
    flex: 1;
    padding: 4px;
    text-align: center;
}

/* Grading Pattern */
.grading-table {
    margin-bottom: 10px;
    font-size: 10px;
}
.grading-table th {
    background-color: #f3f4f6;
    text-align: center;
}
.grading-table td {
    text-align: center;
}

/* Footer */
.footer-row {
    margin-top: auto;
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    padding-top: 10px;
}

.result-status {
    font-size: 14px;
    font-weight: bold;
    margin-bottom: 10px;
}
.result-pass { color: #166534; } /* Green */
.result-fail { color: #dc2626; } /* Red */

.disclaimer {
    font-size: 10px;
    margin-top: 10px;
    border-top: 1px solid #000;
    padding-top: 5px;
}

.qr-section {
    text-align: center;
}
{% endblock %}

{% block content %}
<div class="page-container">
    <div class="content-border">
        
        <!-- Header -->
        <div class="header">
            <div class="logo-section">
                <!-- SVG Logo Placeholder -->
                <svg width="60" height="60" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
                    <path fill="#8B4513" d="M16 2L4 7V14C4 20.732 9.28 27.292 16 30C22.72 27.292 28 20.732 28 14V7L16 2ZM16 27.816C10.424 25.472 6 19.936 6 14V8.2L16 4.2L26 8.2V14C26 19.936 21.576 25.472 16 27.816Z"/>
                    <path fill="#FFFFFF" d="M14.2929 19.7071L21.2929 12.7071C21.6834 12.3166 21.6834 11.6834 21.2929 11.2929C20.9024 10.9024 20.2692 10.9024 19.8787 11.2929L13.5858 17.5858L10.7071 14.7071C10.3166 14.3166 9.68342 14.3166 9.29289 14.7071C8.90237 15.0976 8.90237 15.7308 9.29289 16.1213L12.8787 19.7071C13.2692 20.0976 13.9024 20.0976 14.2929 19.7071Z"/>
                </svg>
            </div>
            <div class="university-info">
                <!-- Top Mini Header -->
                <div style="font-weight: bold; font-size: 16px; margin-bottom: 5px; color: #8B4513;">PPSU</div>
                <!-- Main Title -->
                <div class="ppsu-title">P P SAVANI UNIVERSITY</div>
                <div class="ppsu-subtitle">NH 8, GETCO, Near Biltech, Village: Dhamdod Kosamba</div>
                <div class="ppsu-subtitle">Dist.: Surat - 394125</div>
                <div class="website">www.ppsu.ac.in</div>
            </div>
            <div style="width: 15%; text-align: right;">
                <div class="naac-badge">NAAC A+ GRADE</div>
            </div>
        </div>

        <!-- Title -->
        <div class="report-title">SEMESTER PERFORMANCE REPORT</div>

        <!-- Date / Report No -->
        <div class="date-bar">
            <div>DATE: {{ date }}</div>
            <div>No.: {{ reportNo }}</div>
        </div>

        <!-- Student Info -->
        <table class="student-info-table">
            <tr>
                <td class="label">NAME OF STUDENT</td>
                <td class="value">{{ studentName }}</td>
                <td class="label">ENROLLMENT NO.</td>
                <td class="value">{{ enrollmentNo }}</td>
            </tr>
            <tr>
                <td class="label">SEMESTER</td>
                <td class="value">{{ semester }}</td>
                <td class="label">MONTH-YEAR</td>
                <td class="value">{{ academicYear }}</td>
            </tr>
            <tr>
                <td class="label">INSTITUTION</td>
                <td colspan="3" class="value">{{ institution }}</td>
            </tr>
            <tr>
                <td class="label">PROGRAMME</td>
                <td colspan="3" class="value">{{ course }}</td>
            </tr>
        </table>

        <!-- Course Table -->
        <table class="course-table">
            <thead>
                <tr>
                    <th style="width: 15%;">COURSE CODE</th>
                    <th style="width: 45%;">COURSE NAME</th>
                    <th style="width: 15%;">EVALUATION</th>
                    <th style="width: 10%;">CREDITS</th>
                    <th style="width: 15%;">GRADE</th>
                </tr>
            </thead>
            <tbody>
                {% for subject in subjects %}
                <tr>
                    <td>{{ subject.code }}</td>
                    <td>{{ subject.name }}</td>
                    <td>{{ subject.evaluation }}</td>
                    <td style="text-align: center;">{{ subject.credits }}</td>
                    <td style="text-align: center; font-weight: bold;">{{ subject.grade }}</td>
                </tr>
                {% endfor %}
                
                {# Pad with empty rows to fill space matching the document feel #}
                {% if subjects|length < 8 %}
                    {% for i in range(0, 8 - subjects|length) %}
                    <tr>
                        <td style="height: 24px;">&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                    </tr>
                    {% endfor %}
                {% endif %}
            </tbody>
        </table>

        <!-- Performance Summary -->
        <div class="performance-container">
            <!-- Current Semester -->
            <div class="perf-box">
                <div class="perf-header">CURRENT SEMESTER PERFORMANCE</div>
                <div class="perf-row">
                    <div class="perf-label">REGISTERED CREDITS</div>
                    <div class="perf-value">{{ performance.currentSemester.registeredCredits }}</div>
                </div>
                <div class="perf-row">
                    <div class="perf-label">EARNED CREDITS</div>
                    <div class="perf-value">{{ performance.currentSemester.earnedCredits }}</div>
                </div>
                <div class="perf-row">
                    <div class="perf-label">SGPA</div>
                    <div class="perf-value" style="font-weight: bold;">{{ performance.currentSemester.sgpa }}</div>
                </div>
            </div>

            <!-- Cumulative -->
            <div class="perf-box">
                <div class="perf-header">CUMULATIVE PERFORMANCE</div>
                <div class="perf-row">
                    <div class="perf-label">EARNED CREDITS</div>
                    <div class="perf-value">{{ performance.cumulative.earnedCredits }}</div>
                </div>
                <div class="perf-row">
                    <div class="perf-label">CGPA</div>
                    <div class="perf-value" style="font-weight: bold;">{{ performance.cumulative.cgpa }}</div>
                </div>
                <div class="perf-row">
                    <div class="perf-label">NO. OF BACKLOGS</div>
                    <div class="perf-value">{{ performance.cumulative.backlogs }}</div>
                </div>
            </div>
        </div>

        <!-- Result -->
        <div class="result-status">
            FINAL RESULT: 
            <span class="{% if performance.cumulative.cgpa|float > 4.0 %}result-pass{% else %}result-fail{% endif %}">
                PASSED
            </span>
        </div>

        <!-- Grading Table -->
        <div style="font-size: 10px; font-weight: bold; margin-bottom: 2px;">-:GRADE PATTERNS:-</div>
        <table class="grading-table">
            <thead>
                <tr>
                    <th>%MARKS RANGE</th>
                    <th>90 - 100</th>
                    <th>80 - 89.99</th>
                    <th>70 - 79.99</th>
                    <th>60 - 69.99</th>
                    <th>50 - 59.99</th>
                    <th>45 - 49.99</th>
                    <th>40 - 44.99</th>
                    <th>0 - 39.99</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>GRADE</strong></td>
                    <td>O</td>
                    <td>A+</td>
                    <td>A</td>
                    <td>B+</td>
                    <td>B</td>
                    <td>C</td>
                    <td>P</td>
                    <td>F</td>
                </tr>
                <tr>
                    <td><strong>GRADE POINT</strong></td>
                    <td>10</td>
                    <td>9</td>
                    <td>8</td>
                    <td>7</td>
                    <td>6</td>
                    <td>5</td>
                    <td>4</td>
                    <td>0</td>
                </tr>
            </tbody>
        </table>
        <div style="font-size: 9px; text-align: center; font-style: italic; margin-bottom: 10px;">
            *S = Satisfactory, US = Unsatisfactory
        </div>

        <!-- Footer / QR -->
        <div class="footer-row">
            <div class="qr-section">
                <img src="{{ qrCodeDataUri }}" width="80" height="80" alt="QR Verify" style="display: block; margin: 0 auto; border: 1px solid #ccc; padding: 2px;">
            </div>

            <div style="text-align: center;">
                <div style="font-weight: bold; margin-bottom: 25px;">REGISTRAR</div>
                <div style="font-size: 11px;">P P SAVANI UNIVERSITY</div>
            </div>
        </div>

        <!-- Disclaimer -->
        <div class="disclaimer">
            This is a computer generated report, signature is not required. In case of discrepancy office results will be considered as final.
            <div style="margin-top: 3px;">Printed on: {{ printedOn }}</div>
        </div>

    </div>
</div>
{% endblock %}